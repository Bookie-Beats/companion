{"version":3,"file":"popup.js","sources":["../src/popup/popup.ts"],"sourcesContent":["import {\n  SettingsManager,\n  detectCurrentSite,\n  notifyContentScripts,\n} from \"../lib/settings.js\";\n\nconst toggle = document.getElementById(\"toggle-anno\") as HTMLInputElement;\nconst displayMode = document.getElementById(\n  \"display-mode\"\n) as HTMLSelectElement;\nconst hideCharts = document.getElementById(\"hide-charts\") as HTMLInputElement;\nconst feeModeSelect = document.getElementById(\n  \"fee-mode-select\"\n) as HTMLSelectElement;\nconst kalshiOptions = document.getElementById(\n  \"kalshi-options\"\n) as HTMLDivElement;\nconst siteInfo = document.getElementById(\"site-info\") as HTMLDivElement;\n\nlet settingsManager: SettingsManager;\n\n// Update UI based on detected site\nasync function updateUIForSite(): Promise<void> {\n  const site = await detectCurrentSite();\n\n  if (site === \"kalshi\") {\n    kalshiOptions.style.display = \"block\";\n    siteInfo.textContent = \"Kalshi detected - showing site-specific options\";\n  } else {\n    kalshiOptions.style.display = \"none\";\n    siteInfo.textContent = \"No supported site detected\";\n  }\n}\n\n// Setup event listeners\nfunction setupEventListeners(): void {\n  toggle.addEventListener(\"change\", async () => {\n    await settingsManager.saveSetting(\"extensionEnabled\", toggle.checked);\n  });\n\n  displayMode.addEventListener(\"change\", async () => {\n    await settingsManager.saveSetting(\"oddsDisplayMode\", displayMode.value);\n    await notifyContentScripts({\n      type: \"displayModeChanged\",\n      mode: displayMode.value,\n    });\n  });\n\n  hideCharts.addEventListener(\"change\", async () => {\n    await settingsManager.saveSetting(\"hideCharts\", hideCharts.checked);\n    await notifyContentScripts({\n      type: \"hideChartsChanged\",\n      hide: hideCharts.checked,\n    });\n  });\n\n  feeModeSelect.addEventListener(\"change\", async () => {\n    await settingsManager.saveSetting(\"feeDisplayMode\", feeModeSelect.value);\n    await notifyContentScripts({\n      type: \"feeSettingsChanged\",\n      mode: feeModeSelect.value,\n    });\n  });\n}\n\n// Initialize popup\nasync function initialize(): Promise<void> {\n  // Initialize settings manager with current site\n  settingsManager = new SettingsManager();\n  await settingsManager.init();\n\n  // Update UI based on current site\n  await updateUIForSite();\n\n  // Load and apply settings\n  const settings = await settingsManager.loadSettings();\n  const site = settingsManager.getCurrentSite();\n\n  const enabledKey = site\n    ? `${site}.extensionEnabled`\n    : \"global.extensionEnabled\";\n  const modeKey = site ? `${site}.oddsDisplayMode` : \"global.oddsDisplayMode\";\n  const chartsKey = site ? `${site}.hideCharts` : \"global.hideCharts\";\n\n  toggle.checked = settings[enabledKey] !== false;\n  displayMode.value = settings[modeKey] || \"american\";\n  hideCharts.checked = settings[chartsKey] !== false;\n\n  // Fee settings\n  const feeKey = site ? `${site}.feeDisplayMode` : \"global.feeDisplayMode\";\n  const currentMode = settings[feeKey] || \"taker\";\n\n  // Set dropdown value, default to taker if custom mode\n  if (currentMode === \"custom\") {\n    feeModeSelect.value = \"taker\"; // Default to taker for custom mode\n    feeModeSelect.disabled = true; // Disable dropdown when custom mode active\n  } else {\n    feeModeSelect.value = currentMode;\n    feeModeSelect.disabled = false;\n  }\n\n  // Setup event listeners\n  setupEventListeners();\n}\n\n// Start initialization\ninitialize().catch(console.error);\n"],"names":[],"mappings":";;AAMA,MAAM,SAAS,SAAS,eAAe,aAAa;AACpD,MAAM,cAAc,SAAS;AAAA,EAC3B;AACF;AACA,MAAM,aAAa,SAAS,eAAe,aAAa;AACxD,MAAM,gBAAgB,SAAS;AAAA,EAC7B;AACF;AACA,MAAM,gBAAgB,SAAS;AAAA,EAC7B;AACF;AACA,MAAM,WAAW,SAAS,eAAe,WAAW;AAEpD,IAAI;AAGJ,eAAe,kBAAiC;AAC9C,QAAM,OAAO,MAAM,kBAAA;AAEnB,MAAI,SAAS,UAAU;AACrB,kBAAc,MAAM,UAAU;AAC9B,aAAS,cAAc;AAAA,EACzB,OAAO;AACL,kBAAc,MAAM,UAAU;AAC9B,aAAS,cAAc;AAAA,EACzB;AACF;AAGA,SAAS,sBAA4B;AACnC,SAAO,iBAAiB,UAAU,YAAY;AAC5C,UAAM,gBAAgB,YAAY,oBAAoB,OAAO,OAAO;AAAA,EACtE,CAAC;AAED,cAAY,iBAAiB,UAAU,YAAY;AACjD,UAAM,gBAAgB,YAAY,mBAAmB,YAAY,KAAK;AACtE,UAAM,qBAAqB;AAAA,MACzB,MAAM;AAAA,MACN,MAAM,YAAY;AAAA,IAAA,CACnB;AAAA,EACH,CAAC;AAED,aAAW,iBAAiB,UAAU,YAAY;AAChD,UAAM,gBAAgB,YAAY,cAAc,WAAW,OAAO;AAClE,UAAM,qBAAqB;AAAA,MACzB,MAAM;AAAA,MACN,MAAM,WAAW;AAAA,IAAA,CAClB;AAAA,EACH,CAAC;AAED,gBAAc,iBAAiB,UAAU,YAAY;AACnD,UAAM,gBAAgB,YAAY,kBAAkB,cAAc,KAAK;AACvE,UAAM,qBAAqB;AAAA,MACzB,MAAM;AAAA,MACN,MAAM,cAAc;AAAA,IAAA,CACrB;AAAA,EACH,CAAC;AACH;AAGA,eAAe,aAA4B;AAEzC,oBAAkB,IAAI,gBAAA;AACtB,QAAM,gBAAgB,KAAA;AAGtB,QAAM,gBAAA;AAGN,QAAM,WAAW,MAAM,gBAAgB,aAAA;AACvC,QAAM,OAAO,gBAAgB,eAAA;AAE7B,QAAM,aAAa,OACf,GAAG,IAAI,sBACP;AACJ,QAAM,UAAU,OAAO,GAAG,IAAI,qBAAqB;AACnD,QAAM,YAAY,OAAO,GAAG,IAAI,gBAAgB;AAEhD,SAAO,UAAU,SAAS,UAAU,MAAM;AAC1C,cAAY,QAAQ,SAAS,OAAO,KAAK;AACzC,aAAW,UAAU,SAAS,SAAS,MAAM;AAG7C,QAAM,SAAS,OAAO,GAAG,IAAI,oBAAoB;AACjD,QAAM,cAAc,SAAS,MAAM,KAAK;AAGxC,MAAI,gBAAgB,UAAU;AAC5B,kBAAc,QAAQ;AACtB,kBAAc,WAAW;AAAA,EAC3B,OAAO;AACL,kBAAc,QAAQ;AACtB,kBAAc,WAAW;AAAA,EAC3B;AAGA,sBAAA;AACF;AAGA,aAAa,MAAM,QAAQ,KAAK;"}